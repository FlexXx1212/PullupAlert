<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pullup Alert</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
  <link rel="stylesheet" href="style.css" />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  <link rel="icon" type="image/png" href="favicon.png">
</head>

<body>
  <main id="app">
    <header class="app-header">
      <div class="header-left">
        <div class="title-row">
          <h1 class="app-title">Pullup Alert</h1>
        </div>
        <div class="subtitle-row">
          <p class="app-subtitle">Deine tägliche Klimmzug-Routine</p>
        </div>
      </div>
      <div class="header-right">
        <div class="date-actions">
          <span id="dateStatus" class="date-pill">Heute</span>
          <button id="prevDayBtn" class="btn btn--ghost date-nav-btn" type="button" aria-label="Vorheriger Tag">
            <i class="fa-solid fa-chevron-left" aria-hidden="true"></i>
          </button>
          <button id="todayBtn" class="btn btn--primary date-nav-today" type="button" aria-label="Zurück zu heute">
            <i class="fa-solid fa-calendar-days" aria-hidden="true"></i>
            <span>Heute</span>
          </button>
          <button id="nextDayBtn" class="btn btn--ghost date-nav-btn" type="button" aria-label="Nächster Tag">
            <i class="fa-solid fa-chevron-right" aria-hidden="true"></i>
          </button>
        </div>
        <button id="openSettingsBtn" class="btn btn--ghost settings-btn" type="button" aria-label="Einstellungen öffnen">
          <i class="fa-solid fa-gear" aria-hidden="true"></i>
        </button>
        <div class="standup-inline">
          <span id="standUpTimer" class="standup-timer" style="display: none;"></span>
          <button
            id="standUpReset"
            class="standup-reset"
            type="button"
            aria-label="Stand Up Timer zurücksetzen"
            title="Stand Up Timer zurücksetzen"
            style="display: none;"
          >
            <i class="fas fa-redo" aria-hidden="true"></i>
          </button>
        </div>
      </div>
    </header>

    <!-- Übersicht aller Workouts -->
    <section id="overviewView" class="view view--active" aria-label="Übersicht Workouts">
      <div class="overview-header">
        <h2>Heutige Workouts</h2>
        <button id="addWorkoutBtn" class="btn btn--ghost" aria-label="Neues Workout erstellen">
          + Neu
        </button>
      </div>
      <p class="hint">
        Workouts werden automatisch zur richtigen Uhrzeit gestartet. Du kannst sie auch manuell öffnen.
      </p>

      <div id="workoutList" class="workout-list">
        <!-- Karten werden per JS eingefügt -->
      </div>
    </section>

    <!-- Aktives Workout -->
    <section id="activeView" class="view view--hidden" aria-label="Aktives Workout">
      <button id="backToOverview" class="btn btn--ghost">
        ← Zur Übersicht
      </button>

      <div class="active-layout">
        <div class="timer-section" aria-label="Workout Timer">
          <div id="workoutTimers" class="workout-timers"></div>
        </div>

        <div class="active-container">
          <div class="active-header">
            <h2 id="activeTitle" class="active-title"></h2>
            <p id="activeLabel" class="active-label"></p>
            <p id="activeTime" class="active-time"></p>
            <p id="activeDate" class="active-date"></p>
          </div>

          <div class="active-body">
            <ul id="activeExercises" class="exercise-list">
              <!-- Übungen per JS -->
            </ul>
          </div>

          <div class="active-footer">
            <button id="completeButton" class="btn btn--primary">
              Workout abschließen
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Workout Editor Modal -->
    <div id="workoutModal" class="modal modal--hidden" aria-hidden="true">
      <div class="modal-backdrop" id="modalBackdrop"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">Workout bearbeiten</h2>
          <button id="closeModalBtn" class="btn-icon" aria-label="Schließen">×</button>
        </div>
        <div class="modal-body">
          <form id="workoutForm">
            <input type="hidden" id="editWorkoutId" />

            <div class="form-row">
              <div class="form-group">
                <label for="wfTitle">Titel</label>
                <input type="text" id="wfTitle" required placeholder="z.B. Rücken & Bizeps" />
              </div>
              <div class="form-group">
                <label for="wfCategory">Kategorie</label>
                <select id="wfCategory"></select>
              </div>
            </div>

            <div class="form-row form-row--repeat">
              <div class="repeat-left">
                <div class="form-group" id="wfTimeGroup">
                  <label for="wfTime">Uhrzeit</label>
                  <input type="time" id="wfTime" required />
                </div>
                <div class="form-group is-hidden" id="wfRepeatGroup">
                  <label for="wfRepeatMinutes">Intervall (Minuten)</label>
                  <input type="number" id="wfRepeatMinutes" min="1" value="90" />
                </div>
              </div>
              <div class="repeat-right">
                <div class="form-group form-group--switch repeat-switch">
                  <label for="wfRepeating">Wiederholend</label>
                  <label class="switch">
                    <input type="checkbox" id="wfRepeating">
                    <span class="slider round"></span>
                  </label>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label>Wochentage</label>
              <div class="days-checkboxes" id="wfDaysContainer">
                <!-- Checkboxen per JS -->
              </div>
            </div>

            <div class="form-group">
              <label for="wfExercises">Beschreibung</label>
              <textarea id="wfExercises" rows="4" placeholder="Klimmzüge: [PULLSETS] Sets - [PULLREPS] Reps"></textarea>
              <p class="hint-small">
                Platzhalter: <code>[PREFIXSETS]</code>, <code>[PREFIXREPS]</code>. Mathe erlaubt:
                <code>[PULLSETS*2]</code>, <code>[PULLREPS+5]</code>.
              </p>
              <p class="hint-small">
                Formatierungen sind möglich, z.B. <code>**Text**</code> für Fett und <code>__Text__</code> für Unterstrichenes.
              </p>
              <p class="hint-small" id="exercisePrefixList"></p>
            </div>

            <div class="preview-box">
              <span class="preview-label">Vorschau:</span>
              <div id="wfPreview" class="preview-content">-</div>
            </div>

            <div class="form-group">
              <label>Timer</label>
              <div id="wfTimersContainer" class="timer-editor"></div>
              <button type="button" id="addTimerBtn" class="btn btn--ghost btn--small">+ Timer hinzufügen</button>
            </div>

            <div class="modal-actions">
              <button type="button" id="deleteWorkoutBtn" class="btn btn--danger" style="display: none;">Löschen</button>
              <div class="spacer"></div>
              <button type="button" id="toggleCompletionBtn" class="btn btn--primary"
                aria-label="Workout-Status umschalten">
                <i class="fa-solid fa-check"></i>
              </button>
              <button type="button" id="cancelModalBtn" class="btn btn--ghost">Abbrechen</button>
              <button type="submit" class="btn btn--primary">Speichern</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal modal--hidden" aria-hidden="true">
      <div class="modal-backdrop" id="settingsModalBackdrop"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h2>Einstellungen</h2>
          <button id="closeSettingsBtn" class="btn-icon" aria-label="Schließen">×</button>
        </div>
        <div class="modal-body">
          <div class="settings-section">
            <div class="standup-header">
              <h3>Stand Up Alert</h3>
              <label class="switch">
                <input type="checkbox" id="standUpToggle">
                <span class="slider round"></span>
              </label>
            </div>
            <div class="standup-controls">
              <div class="setting-group">
                <label>Intervall (Min-Max):</label>
                <div class="range-inputs">
                  <input type="number" id="suMinTime" value="45" min="1">
                  <span>-</span>
                  <input type="number" id="suMaxTime" value="75" min="1">
                </div>
              </div>
              <div class="setting-group">
                <label>Steh-Dauer (Min-Max):</label>
                <div class="range-inputs">
                  <input type="number" id="suMinDur" value="10" min="1">
                  <span>-</span>
                  <input type="number" id="suMaxDur" value="20" min="1">
                </div>
              </div>
              <div class="setting-group">
                <div class="standup-header">
                  <label for="suResetOnWorkout">Workout abschluss resetted Stand Up Alert:</label>
                  <label class="switch standup-switch">
                    <input type="checkbox" id="suResetOnWorkout">
                    <span class="slider round"></span>
                  </label>
                </div>
              </div>
              <div class="setting-group setting-group--disabled" id="suResetOnRepeatingGroup">
                <div class="standup-header">
                  <label for="suResetOnRepeatingWorkouts">Gilt auch für Wiederholende Workouts:</label>
                  <label class="switch standup-switch">
                    <input type="checkbox" id="suResetOnRepeatingWorkouts" disabled>
                    <span class="slider round"></span>
                  </label>
                </div>
              </div>
            </div>
          </div>

          <div class="settings-section">
            <h3>Allgemeine Einstellungen</h3>
            <p class="hint-small">
              Kategorien können optional bei Workouts ausgewählt werden. Aktive Kategorien erscheinen in der Übersicht
              und lösen Erinnerungen aus.
            </p>
            <div id="categorySettingsList" class="categories-list"></div>
            <button type="button" id="addCategoryBtn" class="btn btn--ghost btn--small">+ Kategorie hinzufügen</button>
          </div>
          <div class="settings-section">
            <h3>Workout Einstellungen</h3>
            <p class="hint-small">
              Definiere eigene Variablen pro Übung. Daraus entstehen automatisch <code>[PREFIXSETS]</code> und
              <code>[PREFIXREPS]</code>.
            </p>
            <div id="exerciseVariablesList" class="exercise-variables"></div>
            <button type="button" id="addExerciseVariable" class="btn btn--ghost btn--small">+ Variable hinzufügen</button>
          </div>
        </div>
      </div>
    </div>
  </main>
  <script src="app.js"></script>
</body>

</html>
